$("#modal").html("<%= j (render partial: 'shared/modal', locals:{ size: 'lg', content: 'show_images' } ) %>")
$("#modal").modal('show')


function remove_vehicle_image() {
	event.preventDefault()
	let element = event.target.parentElement
	fetch('/vehicles/delete_image_attachment', {
		method: 'POST',
		headers: {           
      'X-CSRF-Token': document.getElementsByName('csrf-token')[0].content,
      'Accept': 'application/json',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ "id": event.target.dataset.id, vehicle_id: <%= @vehicle.id %> })
	})
	.then( response => response.json() )
  .then( response => {
  	console.log(response)
    if (response.status === 'success') {
      element.remove()
      noty_alert(response.status, response.msg)
    }
  } )
  .catch( error => noty_alert('error', 'Ocurrio un error, no se pudo eliminar la imagen') )
}

$("#form-vehicle-add-images").on("ajax:success", function(event) {
    let modal_body = document.getElementsByClassName('modal-body')[0]
    modal_body.innerHTML = ''
    $(".modal-body").html("<%= j ( render partial: 'show_images' ) %>")
    let msg = JSON.parse(event.detail[2].response)
    noty_alert(msg.status, 'Imagen agregada')
  }).on("ajax:error", function(event) {
		let msg = JSON.parse( event.detail[2].response )
		noty_alert(msg.status, msg.msg)
})